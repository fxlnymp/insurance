<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <meta name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <meta name="description" content="Developed By M Abdur Rokib Promy">
    <meta name="author" content="cosmic">
    <meta name="keywords" content="Bootstrap 3, Template, Theme, Responsive, Corporate, Business">
 
      <title>fireRadar</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
   
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 tooltipss and media queries -->
    <!--[if lt IE 9]>
<script src="js/html5shiv.js"></script>
<![endif]-->
  </head>
  <body>  
 <div class="se_bg" style="background:url('assets/img/44.jpg');">
    <div class="container">
      <div class="row mar-b-50">
        <div class="col-xs-12 about wow fadeInDown">
            <h3>注册</h3>
            <form id="s_form" style="background:none;">
                <div class="form-group">
                    <label for="InputEmail">账号：</label>
                    <input type="email" name="email" class="form-control" id="InputEmail" placeholder="请输入您公司的邮箱">
                </div>
                <p class="prompot"></p>
                <div class="form-group">
                    <label for="password">密码：</label>
                    <input type="password" name="password" class="form-control" id="password" placeholder="请输入密码，6-20位字符">
                </div>
                <p class="prompot"></p>
                <div class="form-group">
                    <label for="InputPassword1">确认密码：</label>
                    <input type="password" name="password2" class="form-control" id="InputPassword1" placeholder="请确认上述密码">
                </div>
                <p class="prompot"></p>
                <div class="form-group">
                    <label for="c_name">公司名称：</label>
                    <input type="text" name="c_name" class="form-control" id="c_name" placeholder="请输入公司名称，64位字符以内">
                </div>
                <p class="prompot"></p>
                <div class="form-group">
                    <label for="phone">手机号：</label>
                    <input type="text"  name="tel"  class="form-control tel" id="phone" placeholder="请输入手机号">
                </div>
                
                <p class="prompot"></p>
                <div class="form-group">
                    <label for="yzm">验证码：</label>
                    <input type="text" name="yzm" class="form-control" id="yzm" placeholder="请输入验证码">
                    <img id="yzmimg" src=""  alt=" 验证码" height="34px"/>
                    <span id="yes" class="glyphicon glyphicon-ok"></span>
                    <span id="no" class="glyphicon glyphicon-remove"></span>
                </div>
                <p class="prompot"></p>
                <button id="s_button" type="button" class="btn  btn-primary ">注册</button>
            </form>
        </div>
      </div>
    </div>
 </div>
    <!--footer start-->
   <div id="footer"></div>
    <!-- js placed at the end of the document so the pages load faster -->
     <script src="assets/js/jquery-1.11.1.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
   
    
   <script type="text/javascript" src="assets/js/jquery.flexslider.js"></script>
   <script type="text/javascript" src="assets/js/link-hover.js"></script>
   <script type="text/javascript" src="assets/js/wow.min.js"></script>

   <script type="text/javascript" src="assets/js/owl.carousel.js"></script>

   <script type="text/javascript" src="assets/js/validate-1.14.0.min.js"></script>
   <script type="text/javascript" src="assets/js/md5.js"></script>

    <script>
      
      wow = new WOW(
        {
          boxClass:     'wow',      // default
          animateClass: 'animated', // default
          offset:       0          // default
        }
      );
        wow.init();

    </script>
    <script>
      $(window).load(function() {
        $('[data-zlname = reverse-effect]').mateHover({
          position: 'y-reverse',
          overlayStyle: 'rolling',
          overlayBg: '#fff',
          overlayOpacity: 0.7,
          overlayEasing: 'easeOutCirc',
          rollingPosition: 'top',
          popupEasing: 'easeOutBack',
          popup2Easing: 'easeOutBack'
        });
      });
      $(window).load(function() {
        $('.flexslider').flexslider({
          animation: "slide",
          start: function(slider) {
            $('body').removeClass('loading');
          }
        });
      });

      $(document).ready(function() {
        $("#owl-demo").owlCarousel({
          items : 4
        });
      });
      $(window).scroll(function() {
        $('#skillz').each(function(){
          var imagePos = $(this).offset().top;
          var viewportheight = window.innerHeight;
          console.log(viewportheight);
          var topOfWindow = $(window).scrollTop();
          if (imagePos < topOfWindow+viewportheight) {
            $('.skill_bar').fadeIn('slow');
            $('.skill_one').animate({
              width:'60%'}, 2000);
            $('.skill_two').animate({
              width:'90%'}, 2000);
            $('.skill_three').animate({
              width:'70%'}, 1000);
            $('.skill_four').animate({
              width:'55%'}, 1000);
            $('.skill_bar_progress p').fadeIn('slow',function(){
            });
          }
        });
      });
       $(function(){
          jQuery.validator.addMethod('tel',function(value,element){
              var telmatch = /^1[0-9]{10}$/;
              return this.optional(element) || (telmatch.test(value));
          },'请输入正确的手机号码');

          $('#s_form').validate({
              errorElement: 'span',
              errorClass: 'false',
              validClass: 'right',
              onfocusout: function(element){
                  $(element).valid();
              },
              errorPlacement: function(error,element){
                  element.parent().next().append(error);
              },
              highlight: function(element, errorClass, validClass) {
                  $(element).removeClass('right').addClass('false');
                  $(element).parent().next().removeClass('right').addClass('false').find('i').html('&#xe606;');
              },
              success: function(span){
                  span.parent().removeClass('false').addClass('right');
                  span.prev('.iconfont').html('&#xe607;');
              },
              rules: {
                  email: {
                      required: true
                  },
                  password: {
                      required: true,
                      minlength: 8
                  },
                  password2: {
                      required: true,
                      equalTo: '#password',
                      minlength: 8
                  },
                  tel: {
                      required: true,
                      minlength: 11,
                      maxlength: 11,
                      digits: true
                  },
                  c_name:{
                      required: true
                  },
                  yzm:{
                      required: true
                  }
              },
              messages: {
                  email: {
                      required: '请输入公司邮箱地址'
                  },
                  password: {
                      required: '请设置一个密码',
                      minlength: '密码长度不小于8个字符'
                  },
                  password2: {
                      required: '请再次确认密码',
                      equalTo: '两次输入密码不相同'
                  },
                  tel: {
                      required: '请输入您的常用手机号码',
                      minlength: '手机号码长度为11位',
                      maxlength: '手机号码长度为11位',
                      digits: '手机号码只能输入数字'
                  },
                  c_name:{
                      required:'请输入您公司名称'
                  },
                  yzm:{
                      required:'请输入验证码'
                  }
              }
          });
      });
      $(function(){
       $('#s_button').on('click',function(e){
         e.preventDefault();
         var inputObj=$('.form-control');
         var isEmpty=false;
         for(var i=0;i<inputObj.length;i++){
             if(inputObj[i].value===''){
                 isEmpty=true;
                 break;
             }
         }

         if(!isEmpty){
            $.ajax({
                     url:'http://101.201.253.36:8087/sys/register',
                     contentType: "application/json; charset=utf-8",
                     data: JSON.stringify(GetJsonData()),
                     dataType: "json",
                     success:function(data) {
                         console.log(data.code);
                         if (data.code === 2000) {
                             alert("请求已提交！我们会尽快与您取得联系");
                             $('#InputEmail').val('');
                             $('#password').val('');
                             $('#c_name').val('');
                             $('#phone').val('');
                             $('#InputPassword1').val('');
                             $('#yzm').val('');
                             $('#yes').css("display","none");
                             $('#no').css("display","none");
                             location.href='login.html'
                             
                          }else if(data.code===3008){
                              $('#no').css("display","inline-block");
                              $('#yes').css("display","none");
                         }else{
                             $('#yes').css("display","inline-block");
                         }
                     },
                error:function(data){
                    console.log(data.code);
                    if(data.code !==2000){
                        alert('申请失败，请稍后再试。')
                    }
                }
                 })
                     type:'POST',
         }else{
             alert('填写项不能为空！')
         }
     });
      //json
             function GetJsonData() {
                var pwd=$('#password').val();
                     pwd=hex_md5(pwd);
                     console.log(pwd);
                 var json = {
                      "username":$('#InputEmail').val(),
                      "password": pwd,
                      "company": $('#c_name').val(),
                      "phone": $('#phone').val(),
                      "captcha": $('#yzm').val(),
                      "key":timestamp
                  };
                  return json;

              }
             var timestamp = new Date().getTime();
             window.onload=function() {
                     timestamp = new Date().getTime();
                    $('#yzmimg').attr('src', 'http://101.201.253.36:8087/captcha/get?key=' + timestamp);
                    console.log(1);
                };
              $('#yzmimg').on('click',function(e){
                  e.preventDefault();
                  timestamp = new Date().getTime();
                  $('#yzmimg').attr('src','http://101.201.253.36:8087/captcha/get?key='+timestamp);
                  console.log(2);
              });
      });
    </script>
  </body>
</html>
